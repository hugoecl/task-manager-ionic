<!-- Projetos Premium -->
<ion-header class="ion-no-border">
  <ion-toolbar color="tertiary">
    <ion-buttons slot="start">
      <ion-menu-button></ion-menu-button>
    </ion-buttons>
    <ion-title>Projetos</ion-title>
  </ion-toolbar>
</ion-header>

<ion-content>
  <!-- Category Filter -->
  <div class="filters-section" *ngIf="categories.length > 0">
    <ion-segment [value]="selectedCategoryId || ''" (ionChange)="onCategoryChange($any($event.detail.value))" scrollable>
      <ion-segment-button value="">Todos</ion-segment-button>
      <ion-segment-button *ngFor="let cat of categories" [value]="cat.id">
        {{ cat.name }}
      </ion-segment-button>
    </ion-segment>
  </div>

  <!-- Counter -->
  <div class="counter">
    <span class="count">{{ projects.length }}</span>
    <span class="label">projeto(s)</span>
  </div>

  <!-- Projects Grid -->
  <div class="projects-grid" *ngIf="projects.length > 0">
    <div class="project-card" *ngFor="let project of projects" (click)="goToTasks(project.id)">
      <!-- Gradient Top -->
      <div class="card-gradient" [style.background]="'linear-gradient(135deg, ' + getCategoryColor(project.categoryId) + ' 0%, ' + getCategoryColor(project.categoryId) + '80 100%)'"></div>
      
      <!-- Content -->
      <div class="card-content">
        <h3 class="project-name">{{ project.name }}</h3>
        <span class="project-category">{{ getCategoryName(project.categoryId) }}</span>
        
        <!-- Progress -->
        <div class="progress-info">
          <div class="progress-bar">
            <div class="progress-fill" 
                 [style.width.%]="getTaskCount(project.id).total > 0 ? (getTaskCount(project.id).completed / getTaskCount(project.id).total * 100) : 0"
                 [style.background]="getCategoryColor(project.categoryId)">
            </div>
          </div>
          <span class="progress-text">{{ getTaskCount(project.id).completed }}/{{ getTaskCount(project.id).total }}</span>
        </div>
      </div>
      
      <!-- Actions -->
      <div class="card-actions">
        <button class="action-btn" (click)="editProject(project, $event)">
          <ion-icon name="pencil-outline"></ion-icon>
        </button>
        <button class="action-btn danger" (click)="deleteProject(project, $event)">
          <ion-icon name="trash-outline"></ion-icon>
        </button>
      </div>
    </div>
  </div>

  <!-- Empty State -->
  <div class="empty-state" *ngIf="projects.length === 0">
    <div class="empty-icon">
      <ion-icon name="folder-outline"></ion-icon>
    </div>
    <h3>Sem projetos</h3>
    <p>Cria o teu primeiro projeto</p>
    <ion-button (click)="addProject()">
      <ion-icon slot="start" name="add"></ion-icon>
      Novo Projeto
    </ion-button>
  </div>

  <!-- FAB -->
  <ion-fab slot="fixed" vertical="bottom" horizontal="end">
    <ion-fab-button (click)="addProject()">
      <ion-icon name="add"></ion-icon>
    </ion-fab-button>
  </ion-fab>
</ion-content>
