<!-- Calendário Premium -->
<ion-header class="ion-no-border">
  <ion-toolbar color="tertiary">
    <ion-buttons slot="start">
      <ion-menu-button></ion-menu-button>
    </ion-buttons>
    <ion-title>Calendário</ion-title>
  </ion-toolbar>
</ion-header>

<ion-content>
  <!-- Legend -->
  <div class="legend">
    <div class="legend-item">
      <span class="dot danger"></span>
      <span>Atraso</span>
    </div>
    <div class="legend-item">
      <span class="dot primary"></span>
      <span>Pendente</span>
    </div>
    <div class="legend-item">
      <span class="dot success"></span>
      <span>Concluída</span>
    </div>
  </div>

  <!-- Calendar -->
  <div class="calendar-wrapper">
    <ion-datetime
      presentation="date"
      [value]="selectedDate"
      (ionChange)="onDateChange($event)"
      [highlightedDates]="highlightedDates"
      locale="pt-PT"
      firstDayOfWeek="1"
      size="cover">
    </ion-datetime>
  </div>

  <!-- Selected Day -->
  <div class="day-section">
    <div class="day-header">
      <h2>{{ getFormattedSelectedDate() }}</h2>
      <span class="task-badge" *ngIf="tasksForDate.length > 0">{{ tasksForDate.length }}</span>
    </div>

    <!-- Tasks for day -->
    <div class="day-tasks" *ngIf="tasksForDate.length > 0">
      <div class="day-task" 
           *ngFor="let task of tasksForDate"
           [class.completed]="task.completed"
           [class.overdue]="isOverdue(task)"
           (click)="goToTaskDetail(task.id)">
        
        <div class="task-status" [class.done]="task.completed" [class.late]="isOverdue(task)">
          <ion-icon [name]="task.completed ? 'checkmark-circle' : 'ellipse-outline'"></ion-icon>
        </div>
        
        <div class="task-info">
          <span class="task-title" [class.done]="task.completed">{{ task.title }}</span>
          <span class="task-project">{{ getProjectName(task.projectId) }}</span>
        </div>
        
        <div class="priority-dot" [class]="task.priority"></div>
      </div>
    </div>

    <!-- No tasks -->
    <div class="no-tasks" *ngIf="tasksForDate.length === 0">
      <ion-icon name="calendar-clear-outline"></ion-icon>
      <p>Sem tarefas neste dia</p>
    </div>
  </div>
</ion-content>
